[
    {
        "id": "8b6e3b319b97a18a",
        "type": "tab",
        "label": "Entrance",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "95eb18db5e77ef4c",
        "type": "tab",
        "label": "Kitchen",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "751c2276bdb4df53",
        "type": "tab",
        "label": "Living Room",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "03c58ed96b7b8395",
        "type": "tab",
        "label": "Office",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "fa6bb9cfa58677c8",
        "type": "tab",
        "label": "Bedroom",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "c41ab6f93f6c103e",
        "type": "tab",
        "label": "Bathroom",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "8f5e75d405c57d2f",
        "type": "tab",
        "label": "Hall",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "0ef8a234d4e5690c",
        "type": "tab",
        "label": "System",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "64b48be79869231a",
        "type": "subflow",
        "name": "Hue Remote",
        "info": "",
        "category": "",
        "in": [],
        "out": [
            {
                "x": 800,
                "y": 140,
                "wires": [
                    {
                        "id": "32f72f6651fbaf20",
                        "port": 0
                    }
                ]
            },
            {
                "x": 800,
                "y": 200,
                "wires": [
                    {
                        "id": "9362f6f49aefaa0c",
                        "port": 0
                    }
                ]
            },
            {
                "x": 800,
                "y": 260,
                "wires": [
                    {
                        "id": "fe022aa6286515ce",
                        "port": 0
                    }
                ]
            },
            {
                "x": 800,
                "y": 320,
                "wires": [
                    {
                        "id": "8a400f0e1110a72a",
                        "port": 0
                    }
                ]
            },
            {
                "x": 800,
                "y": 380,
                "wires": [
                    {
                        "id": "a55d6f591fa9f4be",
                        "port": 0
                    }
                ]
            },
            {
                "x": 800,
                "y": 440,
                "wires": [
                    {
                        "id": "a3aea1e27cc11f9b",
                        "port": 0
                    }
                ]
            },
            {
                "x": 800,
                "y": 500,
                "wires": [
                    {
                        "id": "59a9989f23feb6ae",
                        "port": 0
                    }
                ]
            },
            {
                "x": 800,
                "y": 560,
                "wires": [
                    {
                        "id": "89579a6a4e4f99b9",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "MQTT_TOPIC",
                "type": "str",
                "value": "",
                "ui": {
                    "icon": "font-awesome/fa-tv",
                    "label": {
                        "en-US": "Remote Controller Entity"
                    },
                    "type": "input",
                    "opts": {
                        "types": [
                            "str",
                            "env"
                        ]
                    }
                }
            }
        ],
        "meta": {},
        "color": "#DDAA99",
        "status": {
            "x": 780,
            "y": 660,
            "wires": [
                {
                    "id": "32f72f6651fbaf20",
                    "port": 0
                },
                {
                    "id": "9362f6f49aefaa0c",
                    "port": 0
                },
                {
                    "id": "fe022aa6286515ce",
                    "port": 0
                },
                {
                    "id": "8a400f0e1110a72a",
                    "port": 0
                },
                {
                    "id": "a55d6f591fa9f4be",
                    "port": 0
                },
                {
                    "id": "a3aea1e27cc11f9b",
                    "port": 0
                },
                {
                    "id": "59a9989f23feb6ae",
                    "port": 0
                },
                {
                    "id": "89579a6a4e4f99b9",
                    "port": 0
                }
            ]
        }
    },
    {
        "id": "9437c76dc0c1335d",
        "type": "subflow",
        "name": "Auto Lights",
        "info": "",
        "category": "",
        "in": [],
        "out": [],
        "env": [
            {
                "name": "LIGHT_ENTITY",
                "type": "str",
                "value": "",
                "ui": {
                    "icon": "font-awesome/fa-lightbulb-o",
                    "label": {
                        "en-US": "Light Entity"
                    },
                    "type": "input",
                    "opts": {
                        "types": [
                            "str",
                            "env"
                        ]
                    }
                }
            },
            {
                "name": "BRIGHTNESS_SENSOR",
                "type": "str",
                "value": "",
                "ui": {
                    "icon": "font-awesome/fa-adjust",
                    "label": {
                        "en-US": "Brightness Sensor"
                    },
                    "type": "input",
                    "opts": {
                        "types": [
                            "str",
                            "env"
                        ]
                    }
                }
            },
            {
                "name": "DOOR_SENSOR",
                "type": "str",
                "value": "",
                "ui": {
                    "icon": "font-awesome/fa-adjust",
                    "label": {
                        "en-US": "Door Sensor"
                    },
                    "type": "input",
                    "opts": {
                        "types": [
                            "str",
                            "env"
                        ]
                    }
                }
            },
            {
                "name": "MOTION_SENSOR",
                "type": "str",
                "value": "",
                "ui": {
                    "icon": "font-awesome/fa-adjust",
                    "label": {
                        "en-US": "Motion Sensor"
                    },
                    "type": "input",
                    "opts": {
                        "types": [
                            "str",
                            "env"
                        ]
                    }
                }
            },
            {
                "name": "LAST_USED_TIMER",
                "type": "str",
                "value": "",
                "ui": {
                    "icon": "font-awesome/fa-cube",
                    "label": {
                        "en-US": "Last Used Timer"
                    },
                    "type": "input",
                    "opts": {
                        "types": [
                            "str",
                            "num",
                            "bool",
                            "json",
                            "bin",
                            "env",
                            "conf-types"
                        ]
                    }
                }
            }
        ],
        "meta": {},
        "color": "#DDAA99",
        "status": {
            "x": 170,
            "y": 755,
            "wires": [
                {
                    "id": "11417094154650b9",
                    "port": 0
                }
            ]
        }
    },
    {
        "id": "44754de2761b91b1",
        "type": "subflow",
        "name": "AC - Switch",
        "info": "",
        "category": "",
        "in": [],
        "out": [],
        "env": [
            {
                "name": "AC",
                "type": "str",
                "value": ""
            },
            {
                "name": "SWITCH",
                "type": "str",
                "value": ""
            }
        ],
        "meta": {},
        "color": "#DDAA99",
        "status": {
            "x": 1020,
            "y": 260,
            "wires": [
                {
                    "id": "89b5ba5883233dfb",
                    "port": 0
                },
                {
                    "id": "b3db80cfee277d88",
                    "port": 0
                },
                {
                    "id": "232b830dedea4911",
                    "port": 0
                },
                {
                    "id": "8eb6887b9e25f2f8",
                    "port": 0
                }
            ]
        }
    },
    {
        "id": "a9c82ea585250d5c",
        "type": "subflow",
        "name": "Light - Switch",
        "info": "",
        "category": "",
        "in": [],
        "out": [],
        "env": [
            {
                "name": "LIGHT",
                "type": "str",
                "value": ""
            },
            {
                "name": "SWITCH",
                "type": "str",
                "value": ""
            }
        ],
        "meta": {},
        "color": "#DDAA99",
        "status": {
            "x": 1120,
            "y": 220,
            "wires": [
                {
                    "id": "9233ff21d5f5d632",
                    "port": 0
                },
                {
                    "id": "0ff1089ed4f8402e",
                    "port": 0
                },
                {
                    "id": "2a960bc62fe9d1ad",
                    "port": 0
                },
                {
                    "id": "81d9fba568e06482",
                    "port": 0
                }
            ]
        }
    },
    {
        "id": "f88bb71a82464dcf",
        "type": "server",
        "name": "ha",
        "version": 5,
        "addon": false,
        "rejectUnauthorizedCerts": true,
        "ha_boolean": "y|yes|true|on|home|open",
        "connectionDelay": true,
        "cacheJson": true,
        "heartbeat": true,
        "heartbeatInterval": "30",
        "areaSelector": "friendlyName",
        "deviceSelector": "friendlyName",
        "entitySelector": "friendlyName",
        "statusSeparator": ": ",
        "statusYear": "hidden",
        "statusMonth": "short",
        "statusDay": "numeric",
        "statusHourCycle": "h23",
        "statusTimeFormat": "h:m",
        "enableGlobalContextStore": true
    },
    {
        "id": "1031d59e41cceee8",
        "type": "mqtt-broker",
        "name": "mosquitto",
        "broker": "mosquitto.mosquitto.svc.cluster.local",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "b68f145e9b5f00ba",
        "type": "light-scheduler-settings",
        "name": "Singapore",
        "latitude": "1.317897725633881",
        "longitude": "103.90395478583513"
    },
    {
        "id": "e4cf0b65bd6882d1",
        "type": "mqtt in",
        "z": "64b48be79869231a",
        "name": "",
        "topic": "${MQTT_TOPIC}",
        "qos": "2",
        "datatype": "json",
        "broker": "1031d59e41cceee8",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 100,
        "y": 340,
        "wires": [
            [
                "157727b0a8108b71"
            ]
        ]
    },
    {
        "id": "157727b0a8108b71",
        "type": "switch",
        "z": "64b48be79869231a",
        "name": "Button",
        "property": "payload.action",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on_press_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "on_hold_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "up_press_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "up_hold_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "down_press_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "down_hold_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off_press_release",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off_hold_release",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 8,
        "x": 350,
        "y": 340,
        "wires": [
            [
                "32f72f6651fbaf20"
            ],
            [
                "9362f6f49aefaa0c"
            ],
            [
                "fe022aa6286515ce"
            ],
            [
                "8a400f0e1110a72a"
            ],
            [
                "a55d6f591fa9f4be"
            ],
            [
                "a3aea1e27cc11f9b"
            ],
            [
                "59a9989f23feb6ae"
            ],
            [
                "89579a6a4e4f99b9"
            ]
        ]
    },
    {
        "id": "32f72f6651fbaf20",
        "type": "change",
        "z": "64b48be79869231a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Switch 1 Short Press\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "9362f6f49aefaa0c",
        "type": "change",
        "z": "64b48be79869231a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Switch 1 Long Press\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "fe022aa6286515ce",
        "type": "change",
        "z": "64b48be79869231a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Switch 2 Short Press\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "8a400f0e1110a72a",
        "type": "change",
        "z": "64b48be79869231a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Switch 2 Long Press\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "a55d6f591fa9f4be",
        "type": "change",
        "z": "64b48be79869231a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Switch 3 Short Press\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "a3aea1e27cc11f9b",
        "type": "change",
        "z": "64b48be79869231a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Switch 3 Long Press\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "59a9989f23feb6ae",
        "type": "change",
        "z": "64b48be79869231a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Switch 4 Short Press\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "89579a6a4e4f99b9",
        "type": "change",
        "z": "64b48be79869231a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Switch 4 Long Press\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "68a204aaca4d906f",
        "type": "server-state-changed",
        "z": "9437c76dc0c1335d",
        "name": "Lights On for 1h?",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "${LIGHT_ENTITY}",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "on",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "1",
        "forType": "num",
        "forUnits": "hours",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": false,
        "ignorePrevStateUnavailable": false,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 150,
        "y": 515,
        "wires": [
            [
                "eab81267bf8a9ceb"
            ],
            []
        ]
    },
    {
        "id": "eab81267bf8a9ceb",
        "type": "api-current-state",
        "z": "9437c76dc0c1335d",
        "name": "Motion Off for 30m?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "${MOTION_SENSOR}",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "30",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 395,
        "y": 515,
        "wires": [
            [
                "f8ca136f525ea9d9"
            ],
            []
        ]
    },
    {
        "id": "875d7d01689666f5",
        "type": "comment",
        "z": "9437c76dc0c1335d",
        "name": "Lights - Dead man's switch",
        "info": "",
        "x": 140,
        "y": 440,
        "wires": []
    },
    {
        "id": "a19b26586e9631cf",
        "type": "debug",
        "z": "9437c76dc0c1335d",
        "name": "Lights On Too Long",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 520,
        "wires": []
    },
    {
        "id": "f8ca136f525ea9d9",
        "type": "api-call-service",
        "z": "9437c76dc0c1335d",
        "name": "Lights Off",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "light",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "${LIGHT_ENTITY}"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 605,
        "y": 515,
        "wires": [
            [
                "10bfbd94e6f9510f"
            ]
        ]
    },
    {
        "id": "10bfbd94e6f9510f",
        "type": "change",
        "z": "9437c76dc0c1335d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Dead man's switch triggered\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 825,
        "y": 515,
        "wires": [
            [
                "a19b26586e9631cf",
                "0b3383f4e9d1beaf"
            ]
        ]
    },
    {
        "id": "11417094154650b9",
        "type": "link in",
        "z": "9437c76dc0c1335d",
        "name": "Status In",
        "links": [
            "a9194b6c0c9d79ba",
            "0e7cd5392e6cd5f1",
            "92bc101d0a19d91b",
            "0b3383f4e9d1beaf",
            "cac0c010774a38c0",
            "1c46e8fa39e9d555",
            "178043ec809f25fc",
            "906ba48f22324101",
            "93b77fe38d0af726",
            "5a9d8eb91a674d35"
        ],
        "x": 85,
        "y": 755,
        "wires": [
            []
        ]
    },
    {
        "id": "0b3383f4e9d1beaf",
        "type": "link out",
        "z": "9437c76dc0c1335d",
        "name": "Status Out",
        "mode": "link",
        "links": [
            "11417094154650b9"
        ],
        "x": 975,
        "y": 480,
        "wires": []
    },
    {
        "id": "7facb3b46fce500a",
        "type": "comment",
        "z": "9437c76dc0c1335d",
        "name": "Update Node Status",
        "info": "",
        "x": 110,
        "y": 680,
        "wires": []
    },
    {
        "id": "ad0a1d0af7450e18",
        "type": "comment",
        "z": "9437c76dc0c1335d",
        "name": "Lights - Motion",
        "info": "",
        "x": 120,
        "y": 60,
        "wires": []
    },
    {
        "id": "8137ca5cdbde7de6",
        "type": "server-state-changed",
        "z": "9437c76dc0c1335d",
        "name": "Motion Detected",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "${MOTION_SENSOR}",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "on",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "0",
        "forType": "num",
        "forUnits": "seconds",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 160,
        "y": 180,
        "wires": [
            [
                "8939691f53244254"
            ],
            []
        ]
    },
    {
        "id": "704d229175dab141",
        "type": "change",
        "z": "9437c76dc0c1335d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Light Turned On\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1180,
        "y": 200,
        "wires": [
            [
                "906ba48f22324101",
                "052f0188b8e0082e"
            ]
        ]
    },
    {
        "id": "45a6f28106fdd36c",
        "type": "api-current-state",
        "z": "9437c76dc0c1335d",
        "name": "Dark?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "200",
        "halt_if_type": "num",
        "halt_if_compare": "lt",
        "entity_id": "${BRIGHTNESS_SENSOR}",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 530,
        "y": 140,
        "wires": [
            [
                "7c48ea4c2b606677"
            ],
            []
        ]
    },
    {
        "id": "66e887e65681d733",
        "type": "api-current-state",
        "z": "9437c76dc0c1335d",
        "name": "Sunset?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "below_horizon",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "sun.sun",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 540,
        "y": 200,
        "wires": [
            [
                "7c48ea4c2b606677"
            ],
            []
        ]
    },
    {
        "id": "7c48ea4c2b606677",
        "type": "api-current-state",
        "z": "9437c76dc0c1335d",
        "name": "Light Off?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "${LIGHT_ENTITY}",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 740,
        "y": 200,
        "wires": [
            [
                "c439ea5069d4bec2"
            ],
            []
        ]
    },
    {
        "id": "906ba48f22324101",
        "type": "link out",
        "z": "9437c76dc0c1335d",
        "name": "Status Out",
        "mode": "link",
        "links": [
            "11417094154650b9"
        ],
        "x": 1335,
        "y": 220,
        "wires": []
    },
    {
        "id": "40eff425930fde47",
        "type": "ha-wait-until",
        "z": "9437c76dc0c1335d",
        "name": "Wait until no motion",
        "server": "f88bb71a82464dcf",
        "version": 2,
        "outputs": 1,
        "entityId": "${MOTION_SENSOR}",
        "entityIdFilterType": "exact",
        "property": "state",
        "comparator": "is",
        "value": "off",
        "valueType": "str",
        "timeout": "0",
        "timeoutType": "num",
        "timeoutUnits": "seconds",
        "checkCurrentState": true,
        "blockInputOverrides": true,
        "outputProperties": [],
        "entityLocation": "data",
        "entityLocationType": "none",
        "x": 1200,
        "y": 300,
        "wires": [
            [
                "6390d356c73e09fe"
            ]
        ]
    },
    {
        "id": "05a8fbd060d7481c",
        "type": "api-call-service",
        "z": "9437c76dc0c1335d",
        "name": "Lights Off",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "light",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "${LIGHT_ENTITY}"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1980,
        "y": 280,
        "wires": [
            [
                "14f2e0d01cf2e6a4"
            ]
        ]
    },
    {
        "id": "8939691f53244254",
        "type": "function",
        "z": "9437c76dc0c1335d",
        "name": "Door Open?",
        "func": "const doorSensorName = env.get('DOOR_SENSOR');\n\nif (!doorSensorName) {\n    return msg;\n}\n\nconst ha = global.get('homeassistant.ha');\nconst doorState = ha.states[doorSensorName];\n\nif (!doorState || !('state' in doorState)) {\n    node.error(`No door state found in ${doorSensorName}`);\n    return;\n}\n\nif (doorState.state == 'on') {\n    return [msg, null];\n}\n\nreturn [null, msg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 180,
        "wires": [
            [
                "45a6f28106fdd36c",
                "66e887e65681d733"
            ],
            []
        ]
    },
    {
        "id": "14f2e0d01cf2e6a4",
        "type": "change",
        "z": "9437c76dc0c1335d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Light Turned Off\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2160,
        "y": 280,
        "wires": [
            [
                "93b77fe38d0af726"
            ]
        ]
    },
    {
        "id": "93b77fe38d0af726",
        "type": "link out",
        "z": "9437c76dc0c1335d",
        "name": "Status Out",
        "mode": "link",
        "links": [
            "11417094154650b9"
        ],
        "x": 2305,
        "y": 280,
        "wires": []
    },
    {
        "id": "c32cf4a134b13727",
        "type": "api-current-state",
        "z": "9437c76dc0c1335d",
        "name": "Motion still off?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "${MOTION_SENSOR}",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "${LIGHTS_DELAY}",
        "forType": "num",
        "forUnits": "seconds",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 1580,
        "y": 300,
        "wires": [
            [
                "0234a70e3c0af25e"
            ],
            [
                "40eff425930fde47"
            ]
        ]
    },
    {
        "id": "6390d356c73e09fe",
        "type": "delay",
        "z": "9437c76dc0c1335d",
        "name": "",
        "pauseType": "delay",
        "timeout": "60",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1400,
        "y": 300,
        "wires": [
            [
                "c32cf4a134b13727"
            ]
        ]
    },
    {
        "id": "0234a70e3c0af25e",
        "type": "function",
        "z": "9437c76dc0c1335d",
        "name": "Door Open?",
        "func": "const doorSensorName = env.get('DOOR_SENSOR');\n\nif (!doorSensorName) {\n    return msg;\n}\n\nconst ha = global.get('homeassistant.ha');\nconst doorState = ha.states[doorSensorName];\n\nif (!doorState || !('state' in doorState)) {\n    node.error(`No door state found in ${doorSensorName}`);\n    return;\n}\n\nif (doorState.state == 'on') {\n    return [msg, null];\n}\n\nreturn [null, msg];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1790,
        "y": 300,
        "wires": [
            [
                "05a8fbd060d7481c"
            ],
            [
                "4485596ed6dea303"
            ]
        ]
    },
    {
        "id": "4485596ed6dea303",
        "type": "ha-wait-until",
        "z": "9437c76dc0c1335d",
        "name": "Wait until door open",
        "server": "f88bb71a82464dcf",
        "version": 2,
        "outputs": 1,
        "entityId": "${MOTION_SENSOR}",
        "entityIdFilterType": "exact",
        "property": "state",
        "comparator": "is",
        "value": "on",
        "valueType": "str",
        "timeout": "0",
        "timeoutType": "num",
        "timeoutUnits": "seconds",
        "checkCurrentState": true,
        "blockInputOverrides": true,
        "outputProperties": [],
        "entityLocation": "data",
        "entityLocationType": "none",
        "x": 2020,
        "y": 340,
        "wires": [
            [
                "6390d356c73e09fe"
            ]
        ]
    },
    {
        "id": "c439ea5069d4bec2",
        "type": "function",
        "z": "9437c76dc0c1335d",
        "name": "Manual Override?",
        "func": "const lastUsedTimerName = env.get('LAST_USED_TIMER');\n\nif (!lastUsedTimerName) {\n    return msg;\n}\n\nconst ha = global.get('homeassistant.ha');\nconst lastUsedTimer = ha.states[lastUsedTimerName];\n\nif (!lastUsedTimer || !('state' in lastUsedTimer)) {\n    node.error(`No state found in ${lastUsedTimer}`);\n    return;\n}\n\nif (lastUsedTimer.state != 'idle') {\n    return [msg, null];\n}\n\nreturn [null, msg];",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 930,
        "y": 200,
        "wires": [
            [
                "ee5d4e652037a911"
            ],
            [
                "704d229175dab141",
                "40eff425930fde47"
            ]
        ]
    },
    {
        "id": "ee5d4e652037a911",
        "type": "change",
        "z": "9437c76dc0c1335d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"yellow\",\"text\":\"Manual override enabled\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1180,
        "y": 120,
        "wires": [
            [
                "5a9d8eb91a674d35"
            ]
        ]
    },
    {
        "id": "5a9d8eb91a674d35",
        "type": "link out",
        "z": "9437c76dc0c1335d",
        "name": "Status Out",
        "mode": "link",
        "links": [
            "11417094154650b9"
        ],
        "x": 1315,
        "y": 120,
        "wires": []
    },
    {
        "id": "052f0188b8e0082e",
        "type": "api-call-service",
        "z": "9437c76dc0c1335d",
        "name": "Lights On",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "homeassistant",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "${LIGHT_ENTITY}"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1380,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "2f4789f7a54af1ed",
        "type": "api-current-state",
        "z": "9437c76dc0c1335d",
        "name": "Presence?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "${MOTION_SENSOR}",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 550,
        "y": 260,
        "wires": [
            [
                "7c48ea4c2b606677"
            ],
            []
        ]
    },
    {
        "id": "92b0c949bc11a5c9",
        "type": "api-current-state",
        "z": "9437c76dc0c1335d",
        "name": "Dark?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "200",
        "halt_if_type": "num",
        "halt_if_compare": "lt",
        "entity_id": "${BRIGHTNESS_SENSOR}",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 130,
        "y": 260,
        "wires": [
            [
                "2f4789f7a54af1ed"
            ],
            []
        ]
    },
    {
        "id": "a6498f59d0b5faf6",
        "type": "server-state-changed",
        "z": "44754de2761b91b1",
        "name": "AC is running",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "${AC}",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "off",
        "ifStateType": "str",
        "ifStateOperator": "is_not",
        "outputOnlyOnStateChange": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 130,
        "y": 160,
        "wires": [
            [
                "0cb15bd1ddeac6b8"
            ],
            [
                "4619ab0bd97691d3"
            ]
        ]
    },
    {
        "id": "1b86d5f6c0a25e69",
        "type": "api-call-service",
        "z": "44754de2761b91b1",
        "name": "Turn On Switch",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "switch",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "${SWITCH}"
        ],
        "data": "",
        "dataType": "json",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 560,
        "y": 120,
        "wires": [
            [
                "89b5ba5883233dfb"
            ]
        ]
    },
    {
        "id": "d672b65d84bfa882",
        "type": "api-call-service",
        "z": "44754de2761b91b1",
        "name": "Turn Off Switch",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "switch",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "${SWITCH}"
        ],
        "data": "",
        "dataType": "json",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 560,
        "y": 180,
        "wires": [
            [
                "b3db80cfee277d88"
            ]
        ]
    },
    {
        "id": "7ecceb23f5046aff",
        "type": "server-state-changed",
        "z": "44754de2761b91b1",
        "name": "Switch On",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "${SWITCH}",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "on",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 120,
        "y": 360,
        "wires": [
            [
                "8317cda84e9c80c8"
            ],
            [
                "fc4486a2f8098ba7"
            ]
        ]
    },
    {
        "id": "e1689db97fd40b57",
        "type": "api-call-service",
        "z": "44754de2761b91b1",
        "name": "Turn Off AC",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "climate",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "${AC}"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 550,
        "y": 400,
        "wires": [
            [
                "8eb6887b9e25f2f8"
            ]
        ]
    },
    {
        "id": "9584e0dfa376c0b7",
        "type": "api-call-service",
        "z": "44754de2761b91b1",
        "name": "Turn On AC",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "climate",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "${AC}"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 550,
        "y": 320,
        "wires": [
            [
                "232b830dedea4911"
            ]
        ]
    },
    {
        "id": "89b5ba5883233dfb",
        "type": "change",
        "z": "44754de2761b91b1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Switch turned on\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "b3db80cfee277d88",
        "type": "change",
        "z": "44754de2761b91b1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Switch turned off\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "232b830dedea4911",
        "type": "change",
        "z": "44754de2761b91b1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"AC turned on\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "8eb6887b9e25f2f8",
        "type": "change",
        "z": "44754de2761b91b1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"AC turned off\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "0cb15bd1ddeac6b8",
        "type": "api-current-state",
        "z": "44754de2761b91b1",
        "name": "Switch On?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "${SWITCH}",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 330,
        "y": 120,
        "wires": [
            [],
            [
                "1b86d5f6c0a25e69"
            ]
        ]
    },
    {
        "id": "8317cda84e9c80c8",
        "type": "api-current-state",
        "z": "44754de2761b91b1",
        "name": "AC running?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "${AC}",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 330,
        "y": 320,
        "wires": [
            [],
            [
                "9584e0dfa376c0b7"
            ]
        ]
    },
    {
        "id": "fc4486a2f8098ba7",
        "type": "api-current-state",
        "z": "44754de2761b91b1",
        "name": "AC running?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "${AC}",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 330,
        "y": 400,
        "wires": [
            [
                "e1689db97fd40b57"
            ],
            []
        ]
    },
    {
        "id": "4619ab0bd97691d3",
        "type": "api-current-state",
        "z": "44754de2761b91b1",
        "name": "Switch On?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "${SWITCH}",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 330,
        "y": 180,
        "wires": [
            [
                "d672b65d84bfa882"
            ],
            []
        ]
    },
    {
        "id": "96fa14d6e86c5b2f",
        "type": "server-state-changed",
        "z": "a9c82ea585250d5c",
        "name": "Light is On",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "${LIGHT}",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "on",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 120,
        "y": 120,
        "wires": [
            [
                "d68a22d1be135017"
            ],
            [
                "544179925ee47f2d"
            ]
        ]
    },
    {
        "id": "0754ec1fe5cc26f1",
        "type": "api-call-service",
        "z": "a9c82ea585250d5c",
        "name": "Turn On Switch",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "switch",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "${SWITCH}"
        ],
        "data": "",
        "dataType": "json",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 560,
        "y": 80,
        "wires": [
            [
                "9233ff21d5f5d632"
            ]
        ]
    },
    {
        "id": "a8b91c9b45b598e8",
        "type": "api-call-service",
        "z": "a9c82ea585250d5c",
        "name": "Turn Off Switch",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "switch",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "${SWITCH}"
        ],
        "data": "",
        "dataType": "json",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 560,
        "y": 140,
        "wires": [
            [
                "0ff1089ed4f8402e"
            ]
        ]
    },
    {
        "id": "cb3f83376ca2367a",
        "type": "server-state-changed",
        "z": "a9c82ea585250d5c",
        "name": "Switch On",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "${SWITCH}",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "on",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 120,
        "y": 320,
        "wires": [
            [
                "26c6bd5dd0f3f26a"
            ],
            [
                "289013499de8159f"
            ]
        ]
    },
    {
        "id": "eac178a53ce4e827",
        "type": "api-call-service",
        "z": "a9c82ea585250d5c",
        "name": "Turn Off Light",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "light",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "${LIGHT}"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 560,
        "y": 360,
        "wires": [
            [
                "81d9fba568e06482"
            ]
        ]
    },
    {
        "id": "eb4f03aa2b0751c6",
        "type": "api-call-service",
        "z": "a9c82ea585250d5c",
        "name": "Turn On Light",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "light",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "${LIGHT}"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 560,
        "y": 280,
        "wires": [
            [
                "2a960bc62fe9d1ad"
            ]
        ]
    },
    {
        "id": "9233ff21d5f5d632",
        "type": "change",
        "z": "a9c82ea585250d5c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Switch turned on\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "0ff1089ed4f8402e",
        "type": "change",
        "z": "a9c82ea585250d5c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Switch turned off\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "2a960bc62fe9d1ad",
        "type": "change",
        "z": "a9c82ea585250d5c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Light turned on\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "81d9fba568e06482",
        "type": "change",
        "z": "a9c82ea585250d5c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"fill\":\"green\",\"text\":\"Light turned off\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "d68a22d1be135017",
        "type": "api-current-state",
        "z": "a9c82ea585250d5c",
        "name": "Switch Off?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "${SWITCH}",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 330,
        "y": 80,
        "wires": [
            [
                "0754ec1fe5cc26f1"
            ],
            []
        ]
    },
    {
        "id": "26c6bd5dd0f3f26a",
        "type": "api-current-state",
        "z": "a9c82ea585250d5c",
        "name": "Light is Off?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "${LIGHT}",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 330,
        "y": 280,
        "wires": [
            [
                "eb4f03aa2b0751c6"
            ],
            []
        ]
    },
    {
        "id": "289013499de8159f",
        "type": "api-current-state",
        "z": "a9c82ea585250d5c",
        "name": "Light is On?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "${LIGHT}",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 330,
        "y": 360,
        "wires": [
            [
                "eac178a53ce4e827"
            ],
            []
        ]
    },
    {
        "id": "544179925ee47f2d",
        "type": "api-current-state",
        "z": "a9c82ea585250d5c",
        "name": "Switch On?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "${SWITCH}",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 330,
        "y": 140,
        "wires": [
            [
                "a8b91c9b45b598e8"
            ],
            []
        ]
    },
    {
        "id": "ee75fafb4ffd9a2c",
        "type": "comment",
        "z": "8b6e3b319b97a18a",
        "name": "Leaving Home",
        "info": "",
        "x": 110,
        "y": 60,
        "wires": []
    },
    {
        "id": "1f6705cf3cbafbb7",
        "type": "api-call-service",
        "z": "8b6e3b319b97a18a",
        "name": "Turn Off Speakers",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "media_player",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "media_player.home_speakers",
            "media_player.living_room_tv"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 490,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "75ad8e92f5bc17a9",
        "type": "api-current-state",
        "z": "8b6e3b319b97a18a",
        "name": "Home Vacuumed?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.home_vacuumed",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 490,
        "y": 420,
        "wires": [
            [],
            [
                "401f88c5f497a03d"
            ]
        ]
    },
    {
        "id": "401f88c5f497a03d",
        "type": "api-call-service",
        "z": "8b6e3b319b97a18a",
        "name": "Vacuum Home",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "vacuum",
        "service": "start",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "vacuum.vacuum_cleaner"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 720,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "0e5d9f1de0e99dc5",
        "type": "comment",
        "z": "8b6e3b319b97a18a",
        "name": "Arriving Home",
        "info": "",
        "x": 110,
        "y": 540,
        "wires": []
    },
    {
        "id": "772dd8de52012f6b",
        "type": "server-state-changed",
        "z": "8b6e3b319b97a18a",
        "name": "Leave Home Pressed",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 1,
        "exposeAsEntityConfig": "",
        "entityId": "input_button.leave_home",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 180,
        "y": 280,
        "wires": [
            [
                "1f6705cf3cbafbb7",
                "75ad8e92f5bc17a9",
                "a7e21d1bcd19c4bb",
                "efd3221ac35f1134",
                "b543223065b94c6e",
                "aaed8017c7fa3d9f"
            ]
        ]
    },
    {
        "id": "a7e21d1bcd19c4bb",
        "type": "api-call-service",
        "z": "8b6e3b319b97a18a",
        "name": "Turn Off ACs",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "climate",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "group.home_climate"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 470,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "efd3221ac35f1134",
        "type": "api-call-service",
        "z": "8b6e3b319b97a18a",
        "name": "Cancel Timers",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "timer",
        "service": "cancel",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "group.home_automatic_lights_timers",
            "timer.bedroom_sleeping"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 480,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "b543223065b94c6e",
        "type": "api-call-service",
        "z": "8b6e3b319b97a18a",
        "name": "Turn Off Lights",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "homeassistant",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "group.home_lights"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 480,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "270c532b8c19ac96",
        "type": "server-state-changed",
        "z": "8b6e3b319b97a18a",
        "name": "Door Opened",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "binary_sensor.entrance_door_contact",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "off",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 150,
        "y": 620,
        "wires": [
            [
                "84d49a26691371e9"
            ],
            []
        ]
    },
    {
        "id": "84d49a26691371e9",
        "type": "api-current-state",
        "z": "8b6e3b319b97a18a",
        "name": "Home Locked?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.home_locked",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 340,
        "y": 620,
        "wires": [
            [
                "cd7485589133f724",
                "bd0c2c63af0933cf"
            ],
            []
        ]
    },
    {
        "id": "cd7485589133f724",
        "type": "api-call-service",
        "z": "8b6e3b319b97a18a",
        "name": "Unlock Home",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "input_boolean",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "input_boolean.home_locked"
        ],
        "data": "",
        "dataType": "json",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 560,
        "y": 580,
        "wires": [
            []
        ]
    },
    {
        "id": "bd0c2c63af0933cf",
        "type": "api-current-state",
        "z": "8b6e3b319b97a18a",
        "name": "Spotify Playing?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "playing",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "media_player.spotify",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 560,
        "y": 640,
        "wires": [
            [],
            [
                "418002de399fe74e"
            ]
        ]
    },
    {
        "id": "418002de399fe74e",
        "type": "api-call-service",
        "z": "8b6e3b319b97a18a",
        "name": "Play Music",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "script",
        "service": "play_music",
        "areaId": [],
        "deviceId": [],
        "entityId": [],
        "data": "{\"player_id\":\"media_player.home_speakers\",\"player_name\":\"Home Speakers\",\"volume_level\":\"0.20\"}",
        "dataType": "json",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 750,
        "y": 640,
        "wires": [
            []
        ]
    },
    {
        "id": "aaed8017c7fa3d9f",
        "type": "api-call-service",
        "z": "8b6e3b319b97a18a",
        "name": "Lock Home",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "input_boolean",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "input_boolean.home_locked"
        ],
        "data": "",
        "dataType": "json",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 470,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "09456e566d40fb67",
        "type": "subflow:64b48be79869231a",
        "z": "751c2276bdb4df53",
        "d": true,
        "name": "Remote - Desk",
        "env": [
            {
                "name": "LIGHT_ENTITY",
                "value": "light.living_room_lights",
                "type": "str"
            },
            {
                "name": "REMOTE_CTRL_TOPIC",
                "value": "zigbee2mqtt/living_room/remote_desk",
                "type": "str"
            },
            {
                "name": "PRIMARY_LIGHT_SCRIPT",
                "value": "script.living_room_chill_lights",
                "type": "str"
            },
            {
                "name": "SECONDARY_LIGHT_SCRIPT",
                "value": "script.living_room_normal_lights",
                "type": "str"
            },
            {
                "name": "USED_TIMER_ENTITY",
                "value": "timer.living_room_automatic_lights_timer",
                "type": "str"
            },
            {
                "name": "TURN_ON_PRIMARY_SCRIPT",
                "value": "script.bedroom_normal_lights",
                "type": "str"
            },
            {
                "name": "TURN_ON_SECONDARY_SCRIPT",
                "value": "script.bedroom_chill_lights",
                "type": "str"
            },
            {
                "name": "TURN_OFF_SECONDARY_SCRIPT",
                "value": "script.bedroom_chill_atmosphere",
                "type": "str"
            },
            {
                "name": "TURN_ON_NORMAL_SCRIPT",
                "value": "script.bedroom_normal_lights",
                "type": "str"
            },
            {
                "name": "SHORT_ON_SCRIPT",
                "value": "script.bedroom_normal_lights",
                "type": "str"
            },
            {
                "name": "LONG_ON_SCRIPT",
                "value": "script.bedroom_chill_lights",
                "type": "str"
            },
            {
                "name": "LIGHTS_ENTITY",
                "value": "light.bedroom_lights",
                "type": "str"
            },
            {
                "name": "CONTROLLER_TOPIC",
                "value": "zigbee2mqtt/bedroom/controller_bed",
                "type": "str"
            },
            {
                "name": "CONTROLLER_ID",
                "value": "0x001788010968e691",
                "type": "str"
            },
            {
                "name": "LIGHTS",
                "value": "light.bedroom_lights",
                "type": "str"
            }
        ],
        "x": 160,
        "y": 1340,
        "wires": [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
            []
        ]
    },
    {
        "id": "371af45a050f436a",
        "type": "comment",
        "z": "751c2276bdb4df53",
        "name": "Remote Controllers",
        "info": "",
        "x": 130,
        "y": 1280,
        "wires": []
    },
    {
        "id": "63ed827836d4d565",
        "type": "api-call-service",
        "z": "751c2276bdb4df53",
        "name": "Chill Atmosphere",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "script",
        "service": "living_room_chill_atmosphere",
        "areaId": [],
        "deviceId": [],
        "entityId": [],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 495,
        "y": 1490,
        "wires": [
            []
        ]
    },
    {
        "id": "5f3334c569a538fa",
        "type": "api-call-service",
        "z": "751c2276bdb4df53",
        "name": "Toggle AC",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "script",
        "service": "helper_switch_climate",
        "areaId": [],
        "deviceId": [],
        "entityId": [],
        "data": "{\"climate_entity\":\"climate.living_room_ac\"}",
        "dataType": "json",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 475,
        "y": 1390,
        "wires": [
            []
        ]
    },
    {
        "id": "ac1bd3c46a17797f",
        "type": "subflow:64b48be79869231a",
        "z": "751c2276bdb4df53",
        "d": true,
        "name": "Remote - Entrance",
        "env": [
            {
                "name": "LIGHT_ENTITY",
                "value": "light.living_room_lights",
                "type": "str"
            },
            {
                "name": "REMOTE_CTRL_TOPIC",
                "value": "zigbee2mqtt/living_room/remote_entrance",
                "type": "str"
            },
            {
                "name": "PRIMARY_LIGHT_SCRIPT",
                "value": "script.living_room_chill_lights",
                "type": "str"
            },
            {
                "name": "SECONDARY_LIGHT_SCRIPT",
                "value": "script.living_room_normal_lights",
                "type": "str"
            },
            {
                "name": "USED_TIMER_ENTITY",
                "value": "timer.living_room_automatic_lights_timer",
                "type": "str"
            },
            {
                "name": "TURN_ON_PRIMARY_SCRIPT",
                "value": "script.bedroom_normal_lights",
                "type": "str"
            },
            {
                "name": "TURN_ON_SECONDARY_SCRIPT",
                "value": "script.bedroom_chill_lights",
                "type": "str"
            },
            {
                "name": "TURN_OFF_SECONDARY_SCRIPT",
                "value": "script.bedroom_chill_atmosphere",
                "type": "str"
            },
            {
                "name": "TURN_ON_NORMAL_SCRIPT",
                "value": "script.bedroom_normal_lights",
                "type": "str"
            },
            {
                "name": "SHORT_ON_SCRIPT",
                "value": "script.bedroom_normal_lights",
                "type": "str"
            },
            {
                "name": "LONG_ON_SCRIPT",
                "value": "script.bedroom_chill_lights",
                "type": "str"
            },
            {
                "name": "LIGHTS_ENTITY",
                "value": "light.bedroom_lights",
                "type": "str"
            },
            {
                "name": "CONTROLLER_TOPIC",
                "value": "zigbee2mqtt/bedroom/controller_bed",
                "type": "str"
            },
            {
                "name": "CONTROLLER_ID",
                "value": "0x001788010968e691",
                "type": "str"
            },
            {
                "name": "LIGHTS",
                "value": "light.bedroom_lights",
                "type": "str"
            }
        ],
        "x": 170,
        "y": 1440,
        "wires": [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
            []
        ]
    },
    {
        "id": "ddaae18e654a6ba1",
        "type": "subflow:64b48be79869231a",
        "z": "751c2276bdb4df53",
        "d": true,
        "name": "Remote - Sofa",
        "env": [
            {
                "name": "LIGHT_ENTITY",
                "value": "light.living_room_lights",
                "type": "str"
            },
            {
                "name": "REMOTE_CTRL_TOPIC",
                "value": "zigbee2mqtt/living_room/remote_sofa",
                "type": "str"
            },
            {
                "name": "PRIMARY_LIGHT_SCRIPT",
                "value": "script.living_room_chill_lights",
                "type": "str"
            },
            {
                "name": "SECONDARY_LIGHT_SCRIPT",
                "value": "script.living_room_normal_lights",
                "type": "str"
            },
            {
                "name": "USED_TIMER_ENTITY",
                "value": "timer.living_room_automatic_lights_timer",
                "type": "str"
            },
            {
                "name": "TURN_ON_PRIMARY_SCRIPT",
                "value": "script.bedroom_normal_lights",
                "type": "str"
            },
            {
                "name": "TURN_ON_SECONDARY_SCRIPT",
                "value": "script.bedroom_chill_lights",
                "type": "str"
            },
            {
                "name": "TURN_OFF_SECONDARY_SCRIPT",
                "value": "script.bedroom_chill_atmosphere",
                "type": "str"
            },
            {
                "name": "TURN_ON_NORMAL_SCRIPT",
                "value": "script.bedroom_normal_lights",
                "type": "str"
            },
            {
                "name": "SHORT_ON_SCRIPT",
                "value": "script.bedroom_normal_lights",
                "type": "str"
            },
            {
                "name": "LONG_ON_SCRIPT",
                "value": "script.bedroom_chill_lights",
                "type": "str"
            },
            {
                "name": "LIGHTS_ENTITY",
                "value": "light.bedroom_lights",
                "type": "str"
            },
            {
                "name": "CONTROLLER_TOPIC",
                "value": "zigbee2mqtt/bedroom/controller_bed",
                "type": "str"
            },
            {
                "name": "CONTROLLER_ID",
                "value": "0x001788010968e691",
                "type": "str"
            },
            {
                "name": "LIGHTS",
                "value": "light.bedroom_lights",
                "type": "str"
            }
        ],
        "x": 160,
        "y": 1540,
        "wires": [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
            []
        ]
    },
    {
        "id": "64f52d03bd37dfeb",
        "type": "comment",
        "z": "751c2276bdb4df53",
        "name": "TV Lights",
        "info": "",
        "x": 100,
        "y": 60,
        "wires": []
    },
    {
        "id": "0e844f3af9cc9eeb",
        "type": "server-state-changed",
        "z": "751c2276bdb4df53",
        "name": "TV not playing for 5s?",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "media_player.living_room_media_center",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "playing",
        "ifStateType": "str",
        "ifStateOperator": "is_not",
        "outputOnlyOnStateChange": true,
        "for": "5",
        "forType": "num",
        "forUnits": "seconds",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 180,
        "y": 180,
        "wires": [
            [
                "077e71016bbb08c3"
            ],
            [
                "da0de2f531c36dd8"
            ]
        ]
    },
    {
        "id": "da0de2f531c36dd8",
        "type": "api-call-service",
        "z": "751c2276bdb4df53",
        "name": "Turn On TV Lights",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "light",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "light.living_room_tv_lightstrip"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 430,
        "y": 220,
        "wires": [
            [
                "d102125aa8790a6f"
            ]
        ]
    },
    {
        "id": "077e71016bbb08c3",
        "type": "api-call-service",
        "z": "751c2276bdb4df53",
        "name": "Turn Off TV Lights",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "light",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "light.living_room_tv_lightstrip"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 430,
        "y": 120,
        "wires": [
            [
                "814a73ded53825de"
            ]
        ]
    },
    {
        "id": "499439f14f4a03de",
        "type": "comment",
        "z": "751c2276bdb4df53",
        "name": "Curtains",
        "info": "",
        "x": 100,
        "y": 340,
        "wires": []
    },
    {
        "id": "7aa3a001a71495c6",
        "type": "inject",
        "z": "751c2276bdb4df53",
        "name": "At 12:30",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "30 12 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 400,
        "wires": [
            [
                "0889bfbe8132a565"
            ]
        ]
    },
    {
        "id": "452e1c29f99147b6",
        "type": "api-call-service",
        "z": "751c2276bdb4df53",
        "name": "Open Curtains",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "cover",
        "service": "open_cover",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "cover.living_room_curtains"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 760,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "dd174c42c172453c",
        "type": "api-call-service",
        "z": "751c2276bdb4df53",
        "name": "Close Curtains",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "cover",
        "service": "close_cover",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "cover.living_room_curtains"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 760,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "9a2e70aa690a4fa4",
        "type": "server-state-changed",
        "z": "751c2276bdb4df53",
        "name": "Sunset",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "sun.sun",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "below_horizon",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 130,
        "y": 520,
        "wires": [
            [
                "13c4f898f5a5116d"
            ],
            []
        ]
    },
    {
        "id": "c2eebc508f495c94",
        "type": "api-current-state",
        "z": "751c2276bdb4df53",
        "name": "Curtains Closed?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "closed",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "cover.living_room_curtains",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 550,
        "y": 400,
        "wires": [
            [
                "452e1c29f99147b6"
            ],
            []
        ]
    },
    {
        "id": "f370728beaeb81c9",
        "type": "api-current-state",
        "z": "751c2276bdb4df53",
        "name": "Curtains Opened?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "closed",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "cover.living_room_curtains",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 550,
        "y": 520,
        "wires": [
            [
                "dd174c42c172453c"
            ],
            []
        ]
    },
    {
        "id": "a95e7f1cccf22a09",
        "type": "comment",
        "z": "751c2276bdb4df53",
        "name": "Speakers",
        "info": "",
        "x": 100,
        "y": 680,
        "wires": []
    },
    {
        "id": "f891a0238888a2b3",
        "type": "server-state-changed",
        "z": "751c2276bdb4df53",
        "name": "TV Playing",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "media_player.living_room_media_center",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "playing",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "15",
        "forType": "num",
        "forUnits": "seconds",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 140,
        "y": 740,
        "wires": [
            [
                "de65f32f36812a2c"
            ],
            []
        ]
    },
    {
        "id": "de65f32f36812a2c",
        "type": "api-current-state",
        "z": "751c2276bdb4df53",
        "name": "Speakers Playing?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "playing",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "media_player.living_room_speaker",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 350,
        "y": 740,
        "wires": [
            [
                "c1349d450a3cfcf2"
            ],
            []
        ]
    },
    {
        "id": "c1349d450a3cfcf2",
        "type": "api-call-service",
        "z": "751c2276bdb4df53",
        "name": "Stop Speakers",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "media_player",
        "service": "media_stop",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "media_player.living_room_speaker"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 580,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "13c4f898f5a5116d",
        "type": "api-current-state",
        "z": "751c2276bdb4df53",
        "name": "On Holidays?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.holidays",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 340,
        "y": 520,
        "wires": [
            [],
            [
                "f370728beaeb81c9"
            ]
        ]
    },
    {
        "id": "0889bfbe8132a565",
        "type": "api-current-state",
        "z": "751c2276bdb4df53",
        "name": "On Holidays?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.holidays",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 340,
        "y": 400,
        "wires": [
            [],
            [
                "c2eebc508f495c94"
            ]
        ]
    },
    {
        "id": "d102125aa8790a6f",
        "type": "delay",
        "z": "751c2276bdb4df53",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 620,
        "y": 220,
        "wires": [
            [
                "5a78a5079768eb76"
            ]
        ]
    },
    {
        "id": "ad696b405543e680",
        "type": "api-current-state",
        "z": "751c2276bdb4df53",
        "name": "TV Lights Turned On?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "light.living_room_tv_lightstrip",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 1000,
        "y": 220,
        "wires": [
            [],
            [
                "da0de2f531c36dd8"
            ]
        ]
    },
    {
        "id": "814a73ded53825de",
        "type": "delay",
        "z": "751c2276bdb4df53",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 620,
        "y": 120,
        "wires": [
            [
                "84ce0bddc65d2a69"
            ]
        ]
    },
    {
        "id": "84ce0bddc65d2a69",
        "type": "api-current-state",
        "z": "751c2276bdb4df53",
        "name": "TV Playing?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "playing",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "media_player.living_room_media_center",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 790,
        "y": 120,
        "wires": [
            [],
            [
                "2da559c8ee37d813"
            ]
        ]
    },
    {
        "id": "2da559c8ee37d813",
        "type": "api-current-state",
        "z": "751c2276bdb4df53",
        "name": "TV Lights Turned On?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "light.living_room_tv_lightstrip",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 1000,
        "y": 120,
        "wires": [
            [
                "077e71016bbb08c3"
            ],
            []
        ]
    },
    {
        "id": "5a78a5079768eb76",
        "type": "api-current-state",
        "z": "751c2276bdb4df53",
        "name": "TV Playing?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "playing",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "media_player.living_room_media_center",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 790,
        "y": 220,
        "wires": [
            [
                "ad696b405543e680"
            ],
            []
        ]
    },
    {
        "id": "8e9bdb95e32233dc",
        "type": "comment",
        "z": "03c58ed96b7b8395",
        "name": "AC",
        "info": "",
        "x": 90,
        "y": 480,
        "wires": []
    },
    {
        "id": "15a69f485a813c42",
        "type": "server-state-changed",
        "z": "03c58ed96b7b8395",
        "name": "No presence for 5m",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "binary_sensor.office_motion_occupancy",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "off",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "5",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 150,
        "y": 780,
        "wires": [
            [
                "b142faa841b40265"
            ],
            []
        ]
    },
    {
        "id": "b142faa841b40265",
        "type": "api-current-state",
        "z": "03c58ed96b7b8395",
        "name": "Office AC running?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "climate.office_ac_controller",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 390,
        "y": 780,
        "wires": [
            [
                "211bf5dddd5fd4ea"
            ],
            []
        ]
    },
    {
        "id": "211bf5dddd5fd4ea",
        "type": "api-call-service",
        "z": "03c58ed96b7b8395",
        "name": "Turn Off Office AC",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "climate",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "climate.office_ac_controller"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 630,
        "y": 780,
        "wires": [
            []
        ]
    },
    {
        "id": "4c9fc94724c2fb2d",
        "type": "api-current-state",
        "z": "03c58ed96b7b8395",
        "name": "Office AC running?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "climate.office_ac_controller",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 610,
        "y": 600,
        "wires": [
            [],
            [
                "fca036d1ffe4ce55"
            ]
        ]
    },
    {
        "id": "fca036d1ffe4ce55",
        "type": "api-call-service",
        "z": "03c58ed96b7b8395",
        "name": "Turn On Office AC",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "climate",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "climate.office_ac_controller"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 830,
        "y": 600,
        "wires": [
            []
        ]
    },
    {
        "id": "57fe55679a62a588",
        "type": "server-state-changed",
        "z": "03c58ed96b7b8395",
        "name": "Presence for 1m",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "binary_sensor.office_motion_occupancy",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "on",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "1",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 140,
        "y": 540,
        "wires": [
            [
                "ad52222854a835ae"
            ],
            []
        ]
    },
    {
        "id": "54ddf8b425e6f199",
        "type": "server-state-changed",
        "z": "03c58ed96b7b8395",
        "name": "Door Closed for 1m",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "binary_sensor.office_door_contact",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "off",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "1",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 150,
        "y": 600,
        "wires": [
            [
                "4c9fc94724c2fb2d"
            ],
            []
        ]
    },
    {
        "id": "c0b833d4ce06eccc",
        "type": "comment",
        "z": "03c58ed96b7b8395",
        "name": "Lights",
        "info": "",
        "x": 90,
        "y": 60,
        "wires": []
    },
    {
        "id": "85e4c3b9df242372",
        "type": "server-state-changed",
        "z": "03c58ed96b7b8395",
        "d": true,
        "name": "Presence",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "binary_sensor.office_motion_occupancy",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "on",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 140,
        "y": 180,
        "wires": [
            [
                "b387c956757bdb79",
                "0580a3e87d4d023f"
            ],
            [
                "f45bb0b6a9c3a391"
            ]
        ]
    },
    {
        "id": "33da98521cfa98bf",
        "type": "api-call-service",
        "z": "03c58ed96b7b8395",
        "name": "Lights On",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "switch",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "switch.office_controller_entrance_switch_left"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 640,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "f45bb0b6a9c3a391",
        "type": "api-call-service",
        "z": "03c58ed96b7b8395",
        "name": "Lights Off",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "switch",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "switch.office_controller_entrance_switch_left"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 340,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "b387c956757bdb79",
        "type": "api-current-state",
        "z": "03c58ed96b7b8395",
        "name": "Dark?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "200",
        "halt_if_type": "num",
        "halt_if_compare": "lte",
        "entity_id": "sensor.office_motion_illuminance",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 330,
        "y": 120,
        "wires": [
            [
                "33da98521cfa98bf"
            ],
            []
        ]
    },
    {
        "id": "0580a3e87d4d023f",
        "type": "api-current-state",
        "z": "03c58ed96b7b8395",
        "name": "Sunset?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "below_horizon",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "sun.sun",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 340,
        "y": 180,
        "wires": [
            [
                "33da98521cfa98bf"
            ],
            []
        ]
    },
    {
        "id": "719b81c136ea08f8",
        "type": "comment",
        "z": "03c58ed96b7b8395",
        "name": "Remote Controllers",
        "info": "",
        "x": 130,
        "y": 1340,
        "wires": []
    },
    {
        "id": "803fcf8fadf3796c",
        "type": "subflow:44754de2761b91b1",
        "z": "03c58ed96b7b8395",
        "name": "Entrance Switch Right <-> Office AC",
        "env": [
            {
                "name": "AC",
                "value": "climate.office_ac_controller",
                "type": "str"
            },
            {
                "name": "SWITCH",
                "value": "switch.office_controller_entrance_switch_right",
                "type": "str"
            }
        ],
        "x": 200,
        "y": 900,
        "wires": []
    },
    {
        "id": "b48b25603d80bfc0",
        "type": "server-state-changed",
        "z": "03c58ed96b7b8395",
        "name": "Too Hot",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "sensor.office_thermometer_temperature",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "$entities('input_number.too_hot').state",
        "ifStateType": "jsonata",
        "ifStateOperator": "gte",
        "outputOnlyOnStateChange": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 110,
        "y": 660,
        "wires": [
            [
                "845d433260753bda"
            ],
            []
        ]
    },
    {
        "id": "845d433260753bda",
        "type": "api-current-state",
        "z": "03c58ed96b7b8395",
        "name": "Presence?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "binary_sensor.office_motion_occupancy",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 370,
        "y": 640,
        "wires": [
            [
                "4c9fc94724c2fb2d"
            ],
            []
        ]
    },
    {
        "id": "0f0015805e1ca8b4",
        "type": "comment",
        "z": "03c58ed96b7b8395",
        "name": "Vacuum Cleaner",
        "info": "",
        "x": 120,
        "y": 1060,
        "wires": []
    },
    {
        "id": "f291de1a88ea4736",
        "type": "server-state-changed",
        "z": "03c58ed96b7b8395",
        "name": "Vacuum started",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "sensor.vacuum_cleaner_status",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "cleaning",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 160,
        "y": 1120,
        "wires": [
            [
                "3d377b5c43c0a7cb"
            ],
            []
        ]
    },
    {
        "id": "3d377b5c43c0a7cb",
        "type": "api-call-service",
        "z": "03c58ed96b7b8395",
        "name": "Toggle Home Vacuumed",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "input_boolean",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "input_boolean.home_vacuumed"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 410,
        "y": 1120,
        "wires": [
            []
        ]
    },
    {
        "id": "dec7d4405d520a1f",
        "type": "server-state-changed",
        "z": "03c58ed96b7b8395",
        "d": true,
        "name": "Dark?",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "sensor.office_motion_illuminance",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "200",
        "ifStateType": "num",
        "ifStateOperator": "lte",
        "outputOnlyOnStateChange": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 130,
        "y": 320,
        "wires": [
            [
                "9cc806220ffa3ecd"
            ],
            []
        ]
    },
    {
        "id": "9cc806220ffa3ecd",
        "type": "api-current-state",
        "z": "03c58ed96b7b8395",
        "name": "Presence?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "binary_sensor.office_motion_occupancy",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 350,
        "y": 320,
        "wires": [
            [
                "33da98521cfa98bf"
            ],
            []
        ]
    },
    {
        "id": "ea6ac59acc29db9d",
        "type": "server-state-changed",
        "z": "03c58ed96b7b8395",
        "d": true,
        "name": "Is print idle?",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "sensor.p1s_current_stage",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "offline, idle, finish",
        "ifStateType": "str",
        "ifStateOperator": "includes",
        "outputOnlyOnStateChange": true,
        "for": "2",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": true,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 150,
        "y": 1740,
        "wires": [
            [
                "838f69b2867d6f17"
            ],
            [
                "da53b104d01349a5"
            ]
        ]
    },
    {
        "id": "da53b104d01349a5",
        "type": "api-call-service",
        "z": "03c58ed96b7b8395",
        "name": "Turn On Led",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "light",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "light.p1s_chamber_light"
        ],
        "data": "{}",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 410,
        "y": 1780,
        "wires": [
            []
        ]
    },
    {
        "id": "838f69b2867d6f17",
        "type": "api-call-service",
        "z": "03c58ed96b7b8395",
        "name": "Turn Off Led",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "light",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "light.p1s_chamber_light"
        ],
        "data": "{}",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 410,
        "y": 1720,
        "wires": [
            []
        ]
    },
    {
        "id": "252aee5827c860ba",
        "type": "comment",
        "z": "03c58ed96b7b8395",
        "name": "3D Printer Leds",
        "info": "",
        "x": 120,
        "y": 1660,
        "wires": []
    },
    {
        "id": "442e056c51b2b92e",
        "type": "inject",
        "z": "03c58ed96b7b8395",
        "name": "At 14:00",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "00 14 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 1220,
        "wires": [
            [
                "fd4232a462d66e9a"
            ]
        ]
    },
    {
        "id": "3d8e18f5d75109b7",
        "type": "api-call-service",
        "z": "03c58ed96b7b8395",
        "name": "Vacuum Home",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "vacuum",
        "service": "start",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "vacuum.vacuum_cleaner"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 560,
        "y": 1220,
        "wires": [
            []
        ]
    },
    {
        "id": "fd4232a462d66e9a",
        "type": "api-current-state",
        "z": "03c58ed96b7b8395",
        "name": "Home Vacuumed?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.home_vacuumed",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 330,
        "y": 1220,
        "wires": [
            [],
            [
                "3d8e18f5d75109b7"
            ]
        ]
    },
    {
        "id": "fbb8c452b04100a3",
        "type": "subflow:64b48be79869231a",
        "z": "03c58ed96b7b8395",
        "name": "Desk Controller",
        "env": [
            {
                "name": "MQTT_TOPIC",
                "value": "zigbee2mqtt/office/controller_desk",
                "type": "str"
            }
        ],
        "x": 160,
        "y": 1480,
        "wires": [
            [
                "31cd3317a90a3265"
            ],
            [],
            [],
            [],
            [],
            [],
            [
                "1eccf985e02339ef"
            ],
            []
        ]
    },
    {
        "id": "31cd3317a90a3265",
        "type": "api-call-service",
        "z": "03c58ed96b7b8395",
        "name": "Toggle Light",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "switch",
        "service": "toggle",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "switch.office_controller_entrance_switch_left"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 370,
        "y": 1440,
        "wires": [
            []
        ]
    },
    {
        "id": "1eccf985e02339ef",
        "type": "api-call-service",
        "z": "03c58ed96b7b8395",
        "name": "Toggle AC",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "climate",
        "service": "toggle",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "climate.office_ac_controller"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 370,
        "y": 1500,
        "wires": [
            []
        ]
    },
    {
        "id": "ad52222854a835ae",
        "type": "api-current-state",
        "z": "03c58ed96b7b8395",
        "name": "Too Hot?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "$entities('input_number.too_hot').state",
        "halt_if_type": "jsonata",
        "halt_if_compare": "gte",
        "entity_id": "sensor.office_thermometer_temperature",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 360,
        "y": 540,
        "wires": [
            [
                "4c9fc94724c2fb2d"
            ],
            []
        ]
    },
    {
        "id": "20a0f84767f8a0d2",
        "type": "subflow:9437c76dc0c1335d",
        "z": "03c58ed96b7b8395",
        "name": "Office Lights",
        "env": [
            {
                "name": "LIGHT_ENTITY",
                "value": "switch.office_controller_entrance_switch_left",
                "type": "str"
            },
            {
                "name": "BRIGHTNESS_SENSOR",
                "value": "sensor.office_motion_illuminance",
                "type": "str"
            },
            {
                "name": "DOOR_SENSOR",
                "value": "binary_sensor.office_door_contact",
                "type": "str"
            },
            {
                "name": "MOTION_SENSOR",
                "value": "binary_sensor.office_motion_occupancy",
                "type": "str"
            },
            {
                "name": "LAST_USED_TIMER",
                "value": "timer.office_automatic_lights_timer",
                "type": "str"
            }
        ],
        "x": 150,
        "y": 120,
        "wires": []
    },
    {
        "id": "21a21c921ce7a64f",
        "type": "comment",
        "z": "fa6bb9cfa58677c8",
        "name": "Going to Sleep",
        "info": "",
        "x": 120,
        "y": 760,
        "wires": []
    },
    {
        "id": "a48dcada2a38d841",
        "type": "server-state-changed",
        "z": "fa6bb9cfa58677c8",
        "name": "Door Closed 5m",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "binary_sensor.bedroom_door_contact",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "off",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "60",
        "forType": "num",
        "forUnits": "seconds",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 160,
        "y": 980,
        "wires": [
            [
                "33a13bfcc32ef764"
            ],
            []
        ]
    },
    {
        "id": "33a13bfcc32ef764",
        "type": "light-scheduler-filter",
        "z": "fa6bb9cfa58677c8",
        "settings": "b68f145e9b5f00ba",
        "events": "[{\"start\":{\"dow\":1,\"mod\":0},\"end\":{\"dow\":1,\"mod\":360}},{\"start\":{\"dow\":2,\"mod\":0},\"end\":{\"dow\":2,\"mod\":360}},{\"start\":{\"dow\":3,\"mod\":0},\"end\":{\"dow\":3,\"mod\":360}},{\"start\":{\"dow\":4,\"mod\":0},\"end\":{\"dow\":4,\"mod\":360}},{\"start\":{\"dow\":5,\"mod\":0},\"end\":{\"dow\":5,\"mod\":360}},{\"start\":{\"dow\":6,\"mod\":0},\"end\":{\"dow\":6,\"mod\":360}},{\"start\":{\"dow\":0,\"mod\":0},\"end\":{\"dow\":0,\"mod\":360}},{\"start\":{\"dow\":1,\"mod\":1380},\"end\":{\"dow\":2,\"mod\":0}},{\"start\":{\"dow\":2,\"mod\":1380},\"end\":{\"dow\":3,\"mod\":0}},{\"start\":{\"dow\":3,\"mod\":1380},\"end\":{\"dow\":4,\"mod\":0}},{\"start\":{\"dow\":4,\"mod\":1380},\"end\":{\"dow\":5,\"mod\":0}},{\"start\":{\"dow\":5,\"mod\":1380},\"end\":{\"dow\":6,\"mod\":0}},{\"start\":{\"dow\":6,\"mod\":1380},\"end\":{\"dow\":0,\"mod\":0}},{\"start\":{\"dow\":0,\"mod\":1380},\"end\":{\"dow\":1,\"mod\":0}}]",
        "name": "Night Time?",
        "onlyWhenDark": false,
        "scheduleRndMax": 0,
        "sunElevationThreshold": 6,
        "sunShowElevationInStatus": false,
        "x": 350,
        "y": 980,
        "wires": [
            [
                "f79e69ba338a0b8d"
            ],
            []
        ]
    },
    {
        "id": "9019d74dd955c42c",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Turn On Sleeping Timer",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "timer",
        "service": "start",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "timer.bedroom_sleeping"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 750,
        "y": 920,
        "wires": [
            [
                "8b93b84ceca7782f",
                "4874c2e2d65f03de",
                "61190aab1cf44a38",
                "32c7c71ecd2dbd46",
                "aff1cc67187cc2cc",
                "0f56b2703068833f"
            ]
        ]
    },
    {
        "id": "095a869c72667350",
        "type": "comment",
        "z": "fa6bb9cfa58677c8",
        "name": "AC",
        "info": "",
        "x": 90,
        "y": 240,
        "wires": []
    },
    {
        "id": "9da6d3118bc04433",
        "type": "server-state-changed",
        "z": "fa6bb9cfa58677c8",
        "name": "Door Opened 5m",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "binary_sensor.bedroom_door_contact",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "on",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "5",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 160,
        "y": 400,
        "wires": [
            [
                "5bfbcc15a80e8945"
            ],
            []
        ]
    },
    {
        "id": "5bfbcc15a80e8945",
        "type": "api-current-state",
        "z": "fa6bb9cfa58677c8",
        "name": "Bedroom AC running?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "climate.bedroom_ac_controller",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 380,
        "y": 400,
        "wires": [
            [
                "e1eabf25edbbf70f"
            ],
            []
        ]
    },
    {
        "id": "c03a59b5b2299844",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Turn Off Bedroom AC",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "climate",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "climate.bedroom_ac_controller"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 800,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "fce951f1ac71d4a5",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Turn On Bedroom AC",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "climate",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "climate.bedroom_ac_controller"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 620,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "d1a676cc309a4be9",
        "type": "server-state-changed",
        "z": "fa6bb9cfa58677c8",
        "name": "Door Closed 5m?",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "binary_sensor.bedroom_door_contact",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "off",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "5",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 160,
        "y": 560,
        "wires": [
            [
                "4b4ac090d63de69c"
            ],
            []
        ]
    },
    {
        "id": "4b4ac090d63de69c",
        "type": "api-current-state",
        "z": "fa6bb9cfa58677c8",
        "name": "Bedroom AC running?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "climate.bedroom_ac_controller",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 380,
        "y": 560,
        "wires": [
            [],
            [
                "fce951f1ac71d4a5"
            ]
        ]
    },
    {
        "id": "b44d08f8b019f1f7",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Turn On Living Room AC Right",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "climate",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "climate.living_room_right_ac_controller"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1370,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "80e3702126b9231d",
        "type": "api-current-state",
        "z": "fa6bb9cfa58677c8",
        "name": "Living Room Right AC running?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "off",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "climate.living_room_right_ac_controller",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 1070,
        "y": 440,
        "wires": [
            [],
            [
                "b44d08f8b019f1f7"
            ]
        ]
    },
    {
        "id": "a7516f939caeaa3b",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Turn Off Office AC",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "climate",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "group.living_room_ac_controller",
            "climate.office_ac_controller"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1270,
        "y": 1040,
        "wires": [
            []
        ]
    },
    {
        "id": "4874c2e2d65f03de",
        "type": "api-current-state",
        "z": "fa6bb9cfa58677c8",
        "name": "Are there Guests?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.guests",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 1050,
        "y": 1060,
        "wires": [
            [],
            [
                "a7516f939caeaa3b",
                "ab859369e73002d2"
            ]
        ]
    },
    {
        "id": "61190aab1cf44a38",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Turn Off Media Players",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "media_player",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "media_player.home_speakers",
            "media_player.living_room_tv"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1060,
        "y": 820,
        "wires": [
            []
        ]
    },
    {
        "id": "8b93b84ceca7782f",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Close Curtains",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "cover",
        "service": "close_cover",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "group.home_curtains"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1040,
        "y": 880,
        "wires": [
            []
        ]
    },
    {
        "id": "3224e9d5fcf7be0c",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Turn Off Sleeping Timer",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "timer",
        "service": "finish",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "timer.bedroom_sleeping"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 430,
        "y": 1380,
        "wires": [
            [
                "ec065520cae675a9",
                "10e767ea0801a3ee"
            ]
        ]
    },
    {
        "id": "ec065520cae675a9",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Open Home Curtains",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "cover",
        "service": "open_cover",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "group.home_curtains"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 700,
        "y": 1340,
        "wires": [
            []
        ]
    },
    {
        "id": "10e767ea0801a3ee",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Play Music",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "script",
        "service": "play_music",
        "areaId": [],
        "deviceId": [],
        "entityId": [],
        "data": "{\"player_id\":\"media_player.home_speakers\",\"player_name\":\"Home Speakers\",\"volume_level\":\"0.15\",\"playlist\":\"spotify:playlist:37i9dQZF1EIdJI2xV2PSSs\"}",
        "dataType": "json",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 670,
        "y": 1400,
        "wires": [
            []
        ]
    },
    {
        "id": "84140c0780055dde",
        "type": "comment",
        "z": "fa6bb9cfa58677c8",
        "name": "Lights",
        "info": "",
        "x": 90,
        "y": 60,
        "wires": []
    },
    {
        "id": "cd60b9c858879302",
        "type": "subflow:44754de2761b91b1",
        "z": "fa6bb9cfa58677c8",
        "name": "Entrance Switch Three <-> Bedroom AC",
        "env": [
            {
                "name": "AC",
                "value": "climate.bedroom_ac_controller",
                "type": "str"
            },
            {
                "name": "SWITCH",
                "value": "switch.bedroom_controller_entrance_switch_three",
                "type": "str"
            }
        ],
        "x": 240,
        "y": 300,
        "wires": []
    },
    {
        "id": "34820c12e1373123",
        "type": "subflow:a9c82ea585250d5c",
        "z": "fa6bb9cfa58677c8",
        "name": "Entrance Switch Two <-> Bed Light",
        "env": [
            {
                "name": "LIGHT",
                "value": "light.bedroom_light_bed",
                "type": "str"
            },
            {
                "name": "SWITCH",
                "value": "switch.bedroom_controller_entrance_switch_two",
                "type": "str"
            }
        ],
        "x": 220,
        "y": 120,
        "wires": []
    },
    {
        "id": "04a78ed0b35dd113",
        "type": "server-state-changed",
        "z": "fa6bb9cfa58677c8",
        "name": "Go To Sleep Pressed",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 1,
        "exposeAsEntityConfig": "",
        "entityId": "input_button.go_to_sleep",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 180,
        "y": 920,
        "wires": [
            [
                "9019d74dd955c42c"
            ]
        ]
    },
    {
        "id": "821d98900b6da627",
        "type": "server-state-changed",
        "z": "fa6bb9cfa58677c8",
        "name": "Wake Up Pressed",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 1,
        "exposeAsEntityConfig": "",
        "entityId": "input_button.wake_up",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 170,
        "y": 1380,
        "wires": [
            [
                "3224e9d5fcf7be0c"
            ]
        ]
    },
    {
        "id": "b28125ea8a0e1090",
        "type": "comment",
        "z": "fa6bb9cfa58677c8",
        "name": "Waking Up",
        "info": "",
        "x": 100,
        "y": 1260,
        "wires": []
    },
    {
        "id": "06a4fad738cc9ad9",
        "type": "comment",
        "z": "fa6bb9cfa58677c8",
        "name": "Curtains",
        "info": "",
        "x": 100,
        "y": 1580,
        "wires": []
    },
    {
        "id": "8793652b99a68141",
        "type": "inject",
        "z": "fa6bb9cfa58677c8",
        "name": "At 12:30",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "30 12 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 1640,
        "wires": [
            [
                "a9df5d043cd4f9b2"
            ]
        ]
    },
    {
        "id": "eaf045020f53888a",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Open Curtains",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "cover",
        "service": "open_cover",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "cover.bedroom_curtains"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 760,
        "y": 1640,
        "wires": [
            []
        ]
    },
    {
        "id": "2613e3260eaae516",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Close Curtains",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "cover",
        "service": "close_cover",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "cover.bedroom_curtains"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 760,
        "y": 1740,
        "wires": [
            []
        ]
    },
    {
        "id": "b559f4ec1dba92aa",
        "type": "server-state-changed",
        "z": "fa6bb9cfa58677c8",
        "name": "Sunset",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "sun.sun",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "below_horizon",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 130,
        "y": 1740,
        "wires": [
            [
                "f3816294a5e03ba9"
            ],
            []
        ]
    },
    {
        "id": "02644b8f9246b4b2",
        "type": "api-current-state",
        "z": "fa6bb9cfa58677c8",
        "name": "Curtains Closed?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "closed",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "cover.bedroom_curtains",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 550,
        "y": 1640,
        "wires": [
            [
                "eaf045020f53888a"
            ],
            []
        ]
    },
    {
        "id": "3491676d80a4a3c5",
        "type": "api-current-state",
        "z": "fa6bb9cfa58677c8",
        "name": "Curtains Opened?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "closed",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "cover.bedroom_curtains",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 550,
        "y": 1740,
        "wires": [
            [
                "2613e3260eaae516"
            ],
            []
        ]
    },
    {
        "id": "f3816294a5e03ba9",
        "type": "api-current-state",
        "z": "fa6bb9cfa58677c8",
        "name": "On Holidays?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.holidays",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 340,
        "y": 1740,
        "wires": [
            [],
            [
                "3491676d80a4a3c5"
            ]
        ]
    },
    {
        "id": "a9df5d043cd4f9b2",
        "type": "api-current-state",
        "z": "fa6bb9cfa58677c8",
        "name": "On Holidays?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "input_boolean.holidays",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 340,
        "y": 1640,
        "wires": [
            [],
            [
                "02644b8f9246b4b2"
            ]
        ]
    },
    {
        "id": "cd46f32f960f7e84",
        "type": "comment",
        "z": "fa6bb9cfa58677c8",
        "name": "Remote Controllers",
        "info": "",
        "x": 130,
        "y": 1900,
        "wires": []
    },
    {
        "id": "cc944a5380311c08",
        "type": "subflow:64b48be79869231a",
        "z": "fa6bb9cfa58677c8",
        "name": "Bed Controller",
        "env": [
            {
                "name": "MQTT_TOPIC",
                "value": "zigbee2mqtt/bedroom/controller_bed",
                "type": "str"
            }
        ],
        "x": 150,
        "y": 2140,
        "wires": [
            [
                "6e8cf105234b6b3c"
            ],
            [
                "18cb02ec1b3f4b7d"
            ],
            [
                "df3a410d4250e62c"
            ],
            [
                "62383bec320dca89"
            ],
            [
                "fac2dd333752b7c9"
            ],
            [
                "c72884cad5c5fe5d"
            ],
            [
                "88071f4198d6ac45"
            ],
            [
                "0ee7cd3f6f321be1"
            ]
        ]
    },
    {
        "id": "6e8cf105234b6b3c",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Toggle Ceiling Light",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "switch",
        "service": "toggle",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "switch.bedroom_controller_entrance_switch_one"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 450,
        "y": 1960,
        "wires": [
            []
        ]
    },
    {
        "id": "88071f4198d6ac45",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Toggle AC",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "climate",
        "service": "toggle",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "climate.bedroom_ac_controller"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 430,
        "y": 2320,
        "wires": [
            []
        ]
    },
    {
        "id": "0ee7cd3f6f321be1",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Toggle Curtains",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "cover",
        "service": "toggle",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "cover.bedroom_curtains"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 440,
        "y": 2380,
        "wires": [
            []
        ]
    },
    {
        "id": "df3a410d4250e62c",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Increase Bed Light +20%",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "light",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "light.bedroom_light_bed"
        ],
        "data": "{ \"brightness_step_pct\": 20 }",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 470,
        "y": 2080,
        "wires": [
            []
        ]
    },
    {
        "id": "fac2dd333752b7c9",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Decrease Bed Light Brightness",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "light",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "light.bedroom_light_bed"
        ],
        "data": "{ \"brightness_step_pct\": -20 }",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 490,
        "y": 2200,
        "wires": [
            []
        ]
    },
    {
        "id": "62383bec320dca89",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Set Bed Light to 100%",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "light",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "light.bedroom_light_bed"
        ],
        "data": "{ \"brightness_pct\": 100 }",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 460,
        "y": 2140,
        "wires": [
            []
        ]
    },
    {
        "id": "c72884cad5c5fe5d",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Turn Off Bed Light",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "light",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "light.bedroom_light_bed"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 450,
        "y": 2260,
        "wires": [
            []
        ]
    },
    {
        "id": "bd9f7115a617b2cc",
        "type": "api-current-state",
        "z": "fa6bb9cfa58677c8",
        "name": "Temperature > 26.5°?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "26.5",
        "halt_if_type": "num",
        "halt_if_compare": "gt",
        "entity_id": "sensor.living_room_thermometer_temperature",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 800,
        "y": 440,
        "wires": [
            [
                "80e3702126b9231d"
            ],
            []
        ]
    },
    {
        "id": "e1eabf25edbbf70f",
        "type": "api-current-state",
        "z": "fa6bb9cfa58677c8",
        "name": "Sleeping?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "idle",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "timer.bedroom_sleeping",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 580,
        "y": 400,
        "wires": [
            [],
            [
                "c03a59b5b2299844",
                "bd9f7115a617b2cc"
            ]
        ]
    },
    {
        "id": "32c7c71ecd2dbd46",
        "type": "api-current-state",
        "z": "fa6bb9cfa58677c8",
        "name": "Ceiling Light On?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "on",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "switch.bedroom_controller_entrance_switch_one",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 1050,
        "y": 1200,
        "wires": [
            [
                "8e760635a748b647",
                "aa845a45912d372d"
            ],
            []
        ]
    },
    {
        "id": "8e760635a748b647",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Turn Off Ceiling Light",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "switch",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "switch.bedroom_controller_entrance_switch_one"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1280,
        "y": 1160,
        "wires": [
            []
        ]
    },
    {
        "id": "aa845a45912d372d",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Turn On Bed Light",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "switch",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "switch.bedroom_controller_entrance_switch_two"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1270,
        "y": 1220,
        "wires": [
            []
        ]
    },
    {
        "id": "04abcd31e0034c1a",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Wake Up",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "input_button",
        "service": "press",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "input_button.wake_up"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 660,
        "y": 1980,
        "wires": [
            []
        ]
    },
    {
        "id": "18cb02ec1b3f4b7d",
        "type": "light-scheduler-filter",
        "z": "fa6bb9cfa58677c8",
        "settings": "b68f145e9b5f00ba",
        "events": "[{\"start\":{\"dow\":1,\"mod\":300},\"end\":{\"dow\":1,\"mod\":840}},{\"start\":{\"dow\":2,\"mod\":300},\"end\":{\"dow\":2,\"mod\":840}},{\"start\":{\"dow\":3,\"mod\":300},\"end\":{\"dow\":3,\"mod\":840}},{\"start\":{\"dow\":4,\"mod\":300},\"end\":{\"dow\":4,\"mod\":840}},{\"start\":{\"dow\":5,\"mod\":300},\"end\":{\"dow\":5,\"mod\":840}},{\"start\":{\"dow\":6,\"mod\":300},\"end\":{\"dow\":6,\"mod\":840}},{\"start\":{\"dow\":0,\"mod\":300},\"end\":{\"dow\":0,\"mod\":840}}]",
        "name": "Waking Up Time?",
        "onlyWhenDark": false,
        "scheduleRndMax": 0,
        "sunElevationThreshold": 6,
        "sunShowElevationInStatus": false,
        "x": 450,
        "y": 2020,
        "wires": [
            [
                "04abcd31e0034c1a"
            ],
            [
                "9fcd9c289f96c856"
            ]
        ]
    },
    {
        "id": "9fcd9c289f96c856",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Go to Sleep",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "input_button",
        "service": "press",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "input_button.go_to_sleep"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 670,
        "y": 2040,
        "wires": [
            []
        ]
    },
    {
        "id": "aff1cc67187cc2cc",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Turn Off Some Lights",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "homeassistant",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "group.hall_lights",
            "group.living_room_lights"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1060,
        "y": 940,
        "wires": [
            []
        ]
    },
    {
        "id": "ab859369e73002d2",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Turn Off Office Lights",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "homeassistant",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "group.office_lights"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1280,
        "y": 1100,
        "wires": [
            []
        ]
    },
    {
        "id": "0f56b2703068833f",
        "type": "api-call-service",
        "z": "fa6bb9cfa58677c8",
        "name": "Turn Off Living Room ACs",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "climate",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "group.living_room_ac_controller"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 1070,
        "y": 1000,
        "wires": [
            []
        ]
    },
    {
        "id": "f79e69ba338a0b8d",
        "type": "api-current-state",
        "z": "fa6bb9cfa58677c8",
        "name": "Sleeping?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "idle",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "timer.bedroom_sleeping",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 520,
        "y": 980,
        "wires": [
            [],
            [
                "9019d74dd955c42c"
            ]
        ]
    },
    {
        "id": "e755b5728f77f0e3",
        "type": "comment",
        "z": "8f5e75d405c57d2f",
        "name": "Lights",
        "info": "",
        "x": 90,
        "y": 60,
        "wires": []
    },
    {
        "id": "ba9f7fae897a2c5c",
        "type": "server-state-changed",
        "z": "8f5e75d405c57d2f",
        "name": "No Presence for 1m",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "outputs": 2,
        "exposeAsEntityConfig": "",
        "entityId": "binary_sensor.hall_motion_occupancy",
        "entityIdType": "exact",
        "outputInitially": false,
        "stateType": "str",
        "ifState": "off",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputOnlyOnStateChange": true,
        "for": "1",
        "forType": "num",
        "forUnits": "minutes",
        "ignorePrevStateNull": false,
        "ignorePrevStateUnknown": true,
        "ignorePrevStateUnavailable": true,
        "ignoreCurrentStateUnknown": true,
        "ignoreCurrentStateUnavailable": true,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "eventData"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 170,
        "y": 180,
        "wires": [
            [
                "4dd55bf8c354674f"
            ],
            [
                "360206ba25850f32"
            ]
        ]
    },
    {
        "id": "85b048947c99b29d",
        "type": "api-call-service",
        "z": "8f5e75d405c57d2f",
        "name": "Lights On",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "switch",
        "service": "turn_on",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "switch.living_room_controller_wall_left_switch_three"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 760,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "7b5bf1e7252da343",
        "type": "api-current-state",
        "z": "8f5e75d405c57d2f",
        "name": "Dark?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "200",
        "halt_if_type": "num",
        "halt_if_compare": "lte",
        "entity_id": "sensor.hall_motion_illuminance",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 570,
        "y": 200,
        "wires": [
            [
                "85b048947c99b29d"
            ],
            []
        ]
    },
    {
        "id": "9f0c21e46a7c0131",
        "type": "api-current-state",
        "z": "8f5e75d405c57d2f",
        "name": "Sunset?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "below_horizon",
        "halt_if_type": "str",
        "halt_if_compare": "is",
        "entity_id": "sun.sun",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 580,
        "y": 260,
        "wires": [
            [
                "85b048947c99b29d"
            ],
            []
        ]
    },
    {
        "id": "4dd55bf8c354674f",
        "type": "api-call-service",
        "z": "8f5e75d405c57d2f",
        "name": "Lights Off",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "switch",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "switch.living_room_controller_wall_left_switch_three"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 380,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "360206ba25850f32",
        "type": "api-current-state",
        "z": "8f5e75d405c57d2f",
        "name": "Sleeping?",
        "server": "f88bb71a82464dcf",
        "version": 3,
        "outputs": 2,
        "halt_if": "idle",
        "halt_if_type": "str",
        "halt_if_compare": "is_not",
        "entity_id": "timer.bedroom_sleeping",
        "state_type": "str",
        "blockInputOverrides": false,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            }
        ],
        "for": "0",
        "forType": "num",
        "forUnits": "minutes",
        "override_topic": false,
        "state_location": "payload",
        "override_payload": "msg",
        "entity_location": "data",
        "override_data": "msg",
        "x": 380,
        "y": 220,
        "wires": [
            [],
            [
                "7b5bf1e7252da343",
                "9f0c21e46a7c0131"
            ]
        ]
    },
    {
        "id": "51618521485788e4",
        "type": "comment",
        "z": "0ef8a234d4e5690c",
        "name": "Restart Toggles",
        "info": "",
        "x": 120,
        "y": 60,
        "wires": []
    },
    {
        "id": "79ad674e5d7d124f",
        "type": "inject",
        "z": "0ef8a234d4e5690c",
        "name": "At 04:00",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "00 04 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 120,
        "wires": [
            [
                "7a9c47f5a947e1cd"
            ]
        ]
    },
    {
        "id": "7a9c47f5a947e1cd",
        "type": "api-call-service",
        "z": "0ef8a234d4e5690c",
        "name": "Turn Off Toggles",
        "server": "f88bb71a82464dcf",
        "version": 5,
        "debugenabled": false,
        "domain": "input_boolean",
        "service": "turn_off",
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "input_boolean.home_vacuumed"
        ],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "x": 340,
        "y": 120,
        "wires": [
            []
        ]
    }
]